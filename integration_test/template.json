{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Resources" : {
     "S3Bucket" : {
        "Type" : "AWS::S3::Bucket",
        "Properties" : {
           "AccessControl" : "PublicRead",
           "WebsiteConfiguration" : {
              "IndexDocument" : "index.html",
              "ErrorDocument" : "error.html",
              "RoutingRules": [
                  {
                      "RoutingRuleCondition": {
                          "HttpErrorCodeReturnedEquals": "404",
                          "KeyPrefixEquals": "out1/"
                      },
                      "RedirectRule": {
                          "HostName": "ec2-11-22-333-44.compute-1.amazonaws.com",
                          "ReplaceKeyPrefixWith": "report-404/"
                      }
                  }
              ]
           }
        },
        "DeletionPolicy" : "Retain"
     }
  },
  "Outputs" : {
     "WebsiteURL" : {
        "Value" : { "Fn::GetAtt" : [ "S3Bucket", "WebsiteURL" ] },
        "Description" : "URL for website hosted on S3"
     },
     "S3BucketSecureURL" : {
        "Value" : { "Fn::Join" : [
           "", [ "https://", { "Fn::GetAtt" : [ "S3Bucket", "DomainName" ] } ]
        ] },
        "Description" : "Name of S3 bucket to hold website content"
     }
  }
}
